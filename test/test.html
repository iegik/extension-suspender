<!DOCTYPE html>
<html>
<head>
  <title>Tab Suspender Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .status {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-weight: bold;
    }
    .active {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .suspended {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .timer {
      font-size: 24px;
      font-weight: bold;
      color: #007bff;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Tab Suspender Test Page</h1>

    <div id="status" class="status active">
      Status: Active Tab
    </div>

    <div class="timer" id="timer">00:00</div>

    <p>This page will help you test the Tab Suspender extension:</p>

    <ul>
      <li>Leave this tab inactive for the configured timeout period</li>
      <li>The tab should be suspended (URL will change to about:blank#...)</li>
      <li>Click on the tab to restore it</li>
      <li>The timer below will help you track time</li>
    </ul>

    <button onclick="startTimer()">Start Timer</button>
    <button onclick="stopTimer()">Stop Timer</button>
    <button onclick="resetTimer()">Reset Timer</button>

    <h3>Test Features:</h3>
    <ul>
      <li><strong>Timer:</strong> Tracks how long the tab has been active</li>
      <li><strong>Status Indicator:</strong> Shows if the tab is active or suspended</li>
      <li><strong>Background Tasks:</strong> This page creates timers and intervals to test suspension</li>
    </ul>

    <div id="logs"></div>
  </div>

  <script>
    let startTime = Date.now();
    let timerInterval;
    let isRunning = false;

    function updateTimer() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      document.getElementById('timer').textContent =
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    function startTimer() {
      if (!isRunning) {
        isRunning = true;
        timerInterval = setInterval(updateTimer, 1000);
        log('Timer started');
      }
    }

    function stopTimer() {
      if (isRunning) {
        isRunning = false;
        clearInterval(timerInterval);
        log('Timer stopped');
      }
    }

    function resetTimer() {
      stopTimer();
      startTime = Date.now();
      updateTimer();
      log('Timer reset');
    }

    function log(message) {
      const logs = document.getElementById('logs');
      const time = new Date().toLocaleTimeString();
      logs.innerHTML += `<div>[${time}] ${message}</div>`;
    }

    // Check if this is a suspended tab
    function checkSuspension() {
      if (window.location.href.startsWith('about:blank#')) {
        document.getElementById('status').className = 'status suspended';
        document.getElementById('status').textContent = 'Status: Suspended Tab';
        log('Tab is suspended');
      } else {
        document.getElementById('status').className = 'status active';
        document.getElementById('status').textContent = 'Status: Active Tab';
        log('Tab is active');
      }
    }

    // Create some background tasks to test suspension
    let testInterval = setInterval(() => {
      log('Background task running...');
    }, 5000);

    // Check suspension status on load
    checkSuspension();

    // Start timer automatically
    startTimer();

    // Log page load
    log('Test page loaded');
  </script>
</body>
</html>